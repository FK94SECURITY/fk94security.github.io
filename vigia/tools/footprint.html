<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Footprint Analyzer - Vig√≠a</title>
    <meta name="description" content="Analyze your digital exposure. See what attackers can find about you online.">
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg: #0a0a0b;
            --bg-card: #18181b;
            --bg-hover: #1f1f23;
            --text: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --accent: #10b981;
            --accent-dim: rgba(16, 185, 129, 0.1);
            --border: #27272a;
            --red: #ef4444;
            --yellow: #eab308;
            --blue: #3b82f6;
            --purple: #8b5cf6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container { max-width: 1000px; margin: 0 auto; padding: 24px; }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 40px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--text);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .logo svg { width: 32px; height: 32px; }

        .back { color: var(--text-muted); text-decoration: none; font-size: 0.9rem; }
        .back:hover { color: var(--accent); }

        /* Hero */
        .hero {
            text-align: center;
            margin-bottom: 48px;
        }

        .hero-icon {
            width: 80px;
            height: 80px;
            background: var(--accent-dim);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto 24px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            50% { box-shadow: 0 0 0 20px rgba(16, 185, 129, 0); }
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }

        .hero h1 span { color: var(--accent); }

        .hero p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Input Section */
        .input-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .input-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }

        .tab {
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab:hover { border-color: var(--text-muted); }
        .tab.active {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--bg);
            font-weight: 600;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
        }

        .input-wrapper input {
            flex: 1;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 16px 20px;
            font-size: 1.1rem;
            color: var(--text);
            outline: none;
            transition: border-color 0.2s;
        }

        .input-wrapper input:focus { border-color: var(--accent); }
        .input-wrapper input::placeholder { color: var(--text-muted); }

        .btn {
            background: var(--accent);
            color: var(--bg);
            border: none;
            border-radius: 12px;
            padding: 16px 32px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover { background: #059669; transform: translateY(-2px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 60px 0;
        }

        .loading.active { display: block; }

        .spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .loading-step {
            color: var(--accent);
            font-size: 0.9rem;
            margin-top: 8px;
        }

        /* Results */
        .results {
            display: none;
        }

        .results.active { display: block; }

        /* Exposure Score */
        .exposure-score {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 32px;
            align-items: center;
        }

        .score-circle {
            width: 140px;
            height: 140px;
            position: relative;
        }

        .score-circle svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }

        .score-bg {
            fill: none;
            stroke: var(--border);
            stroke-width: 10;
        }

        .score-fill {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease, stroke 0.5s;
        }

        .score-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .score-number {
            font-size: 2.5rem;
            font-weight: 800;
            line-height: 1;
        }

        .score-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .score-info h2 {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .score-info p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .score-breakdown {
            display: flex;
            gap: 24px;
        }

        .breakdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .breakdown-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Result Cards Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .result-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
        }

        .result-card.full { grid-column: 1 / -1; }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-dim);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .card-header h3 {
            font-size: 1rem;
            font-weight: 600;
        }

        .card-header .status {
            margin-left: auto;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status.found { background: rgba(239, 68, 68, 0.1); color: var(--red); }
        .status.safe { background: var(--accent-dim); color: var(--accent); }
        .status.warning { background: rgba(234, 179, 8, 0.1); color: var(--yellow); }

        /* Gravatar */
        .gravatar-content {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .gravatar-img {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--border);
        }

        .gravatar-info p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Accounts List */
        .accounts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .account-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            background: var(--bg);
            border-radius: 8px;
            text-decoration: none;
            color: var(--text);
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .account-item:hover {
            background: var(--bg-hover);
            transform: translateX(4px);
        }

        .account-item .icon { font-size: 1rem; }
        .account-item .arrow { margin-left: auto; color: var(--text-muted); }

        /* Google Dorks */
        .dorks-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .dork-item {
            background: var(--bg);
            border-radius: 8px;
            padding: 16px;
        }

        .dork-query {
            font-family: 'SF Mono', monospace;
            font-size: 0.85rem;
            color: var(--accent);
            background: var(--accent-dim);
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 8px;
            word-break: break-all;
        }

        .dork-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .dork-btn {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .dork-btn:hover { background: var(--bg-hover); border-color: var(--accent); }

        /* Risk Analysis */
        .risks-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .risk-item {
            background: var(--bg);
            border-radius: 8px;
            padding: 16px;
            border-left: 3px solid var(--red);
        }

        .risk-item h4 {
            font-size: 0.9rem;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .risk-item p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Recommendations */
        .rec-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .rec-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg);
            border-radius: 8px;
        }

        .rec-icon {
            width: 28px;
            height: 28px;
            background: var(--accent-dim);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .rec-item span { font-size: 0.9rem; }

        /* Export */
        .export-section {
            background: linear-gradient(135deg, var(--accent-dim), transparent);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
        }

        .export-section h3 { margin-bottom: 8px; }
        .export-section p { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 16px; }

        .export-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover { background: var(--bg-hover); }

        /* Footer */
        footer {
            margin-top: 60px;
            padding: 24px 0;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .powered-by {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .powered-by a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 { font-size: 1.75rem; }
            .input-wrapper { flex-direction: column; }
            .btn { width: 100%; justify-content: center; }
            .exposure-score { grid-template-columns: 1fr; text-align: center; }
            .score-circle { margin: 0 auto; }
            .score-breakdown { justify-content: center; flex-wrap: wrap; }
            .results-grid { grid-template-columns: 1fr; }
            .accounts-grid { grid-template-columns: repeat(2, 1fr); }
            .risks-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../" class="logo">
                <svg viewBox="0 0 48 48" fill="none">
                    <g transform="translate(4, 4)">
                        <path d="M4 20C4 20 11 6 20 6C29 6 36 20 36 20C36 20 29 34 20 34C11 34 4 20 4 20Z" stroke="#10b981" stroke-width="2.5" fill="none"/>
                        <circle cx="20" cy="20" r="8" fill="#10b981"/>
                        <circle cx="20" cy="20" r="3.5" fill="#0a0a0b"/>
                    </g>
                </svg>
                VIG√çA
            </a>
            <a href="../" class="back">‚Üê Back to Tools</a>
        </header>

        <main>
            <div class="hero">
                <div class="hero-icon">üîé</div>
                <h1>Digital <span>Footprint</span> Analyzer</h1>
                <p>See what information is publicly available about you online. Understand your exposure before attackers do.</p>
            </div>

            <div class="input-section">
                <div class="input-tabs">
                    <button class="tab active" data-type="email">üìß Email</button>
                    <button class="tab" data-type="username">üë§ Username</button>
                </div>
                <div class="input-wrapper">
                    <input type="text" id="input" placeholder="Enter your email address...">
                    <button class="btn" id="analyzeBtn" onclick="analyze()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                        </svg>
                        Analyze
                    </button>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div class="loading-text">Analyzing your digital footprint...</div>
                <div class="loading-step" id="loadingStep">Checking Gravatar...</div>
            </div>

            <div class="results" id="results">
                <!-- Exposure Score -->
                <div class="exposure-score">
                    <div class="score-circle">
                        <svg viewBox="0 0 100 100">
                            <circle class="score-bg" cx="50" cy="50" r="45"/>
                            <circle class="score-fill" id="scoreFill" cx="50" cy="50" r="45"
                                stroke-dasharray="283" stroke-dashoffset="283"/>
                        </svg>
                        <div class="score-value">
                            <div class="score-number" id="scoreNumber">0</div>
                            <div class="score-label">Exposure</div>
                        </div>
                    </div>
                    <div class="score-info">
                        <h2 id="scoreTitle">Calculating...</h2>
                        <p id="scoreDesc">Your digital exposure level based on publicly available information.</p>
                        <div class="score-breakdown">
                            <div class="breakdown-item">
                                <div class="breakdown-dot" style="background: var(--accent);"></div>
                                <span id="foundCount">0 accounts found</span>
                            </div>
                            <div class="breakdown-item">
                                <div class="breakdown-dot" style="background: var(--yellow);"></div>
                                <span id="riskCount">0 risk factors</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="results-grid">
                    <!-- Gravatar -->
                    <div class="result-card" id="gravatarCard">
                        <div class="card-header">
                            <div class="card-icon">üë§</div>
                            <h3>Profile Picture</h3>
                            <span class="status" id="gravatarStatus">Checking...</span>
                        </div>
                        <div class="gravatar-content" id="gravatarContent">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- Breach Check -->
                    <div class="result-card">
                        <div class="card-header">
                            <div class="card-icon">üîì</div>
                            <h3>Data Breaches</h3>
                            <span class="status warning">Check Required</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 12px;">
                            Request a free breach check to see if your data was exposed:
                        </p>
                        <a href="breach-checker.html" class="account-item" style="justify-content: center; background: var(--accent-dim);">
                            <span>Request Free Breach Check</span>
                            <span class="arrow">‚Üí</span>
                        </a>
                    </div>

                    <!-- Possible Accounts -->
                    <div class="result-card full">
                        <div class="card-header">
                            <div class="card-icon">üîó</div>
                            <h3>Possible Accounts</h3>
                            <span class="status" id="accountsStatus">Analyzing...</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 16px;">
                            Based on your username, these accounts may exist. Click to verify:
                        </p>
                        <div class="accounts-grid" id="accountsGrid">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- Google Dorks -->
                    <div class="result-card full">
                        <div class="card-header">
                            <div class="card-icon">üîç</div>
                            <h3>Deep Search Queries</h3>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 16px;">
                            Advanced Google searches to find public information about you:
                        </p>
                        <div class="dorks-list" id="dorksList">
                            <!-- Filled by JS -->
                        </div>
                    </div>

                    <!-- Risk Analysis -->
                    <div class="result-card">
                        <div class="card-header">
                            <div class="card-icon">‚ö†Ô∏è</div>
                            <h3>Risk Analysis</h3>
                        </div>
                        <div class="risks-grid">
                            <div class="risk-item">
                                <h4>üé£ Phishing</h4>
                                <p>Personalized scam emails mentioning your accounts</p>
                            </div>
                            <div class="risk-item">
                                <h4>üé≠ Social Engineering</h4>
                                <p>Using your public info to gain trust</p>
                            </div>
                            <div class="risk-item">
                                <h4>üîë Credential Stuffing</h4>
                                <p>Leaked passwords tried on other accounts</p>
                            </div>
                            <div class="risk-item">
                                <h4>üìû Vishing</h4>
                                <p>Fake calls with real data about you</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recommendations -->
                    <div class="result-card">
                        <div class="card-header">
                            <div class="card-icon">‚úÖ</div>
                            <h3>Recommendations</h3>
                        </div>
                        <div class="rec-list">
                            <div class="rec-item">
                                <span class="rec-icon">üîê</span>
                                <span>Use unique passwords for each account</span>
                            </div>
                            <div class="rec-item">
                                <span class="rec-icon">üì±</span>
                                <span>Enable 2FA on all critical accounts</span>
                            </div>
                            <div class="rec-item">
                                <span class="rec-icon">üìß</span>
                                <span>Use email aliases for signups</span>
                            </div>
                            <div class="rec-item">
                                <span class="rec-icon">üßπ</span>
                                <span>Review & delete old unused accounts</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Export -->
                <div class="export-section">
                    <h3>üìÑ Export Report</h3>
                    <p>Save your analysis for future reference or share with your security team.</p>
                    <div class="export-buttons">
                        <button class="btn btn-secondary" onclick="copyReport()">
                            üìã Copy to Clipboard
                        </button>
                        <button class="btn" onclick="downloadReport()">
                            ‚¨áÔ∏è Download Report
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <div class="powered-by">
                Created by <a href="https://fk94security.com">FK94 Security</a>
            </div>
        </footer>
    </div>

    <script>
        let currentType = 'email';
        let analysisData = {};

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentType = tab.dataset.type;
                document.getElementById('input').placeholder =
                    currentType === 'email' ? 'Enter your email address...' : 'Enter a username...';
            });
        });

        // Enter to analyze
        document.getElementById('input').addEventListener('keypress', e => {
            if (e.key === 'Enter') analyze();
        });

        // MD5 for Gravatar (clean implementation)
        function md5(string) {
            function rotateLeft(value, shift) {
                return (value << shift) | (value >>> (32 - shift));
            }
            function addUnsigned(x, y) {
                var lsw = (x & 0xFFFF) + (y & 0xFFFF);
                var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
                return (msw << 16) | (lsw & 0xFFFF);
            }
            function F(x, y, z) { return (x & y) | ((~x) & z); }
            function G(x, y, z) { return (x & z) | (y & (~z)); }
            function H(x, y, z) { return (x ^ y ^ z); }
            function I(x, y, z) { return (y ^ (x | (~z))); }
            function FF(a, b, c, d, x, s, ac) {
                a = addUnsigned(a, addUnsigned(addUnsigned(F(b, c, d), x), ac));
                return addUnsigned(rotateLeft(a, s), b);
            }
            function GG(a, b, c, d, x, s, ac) {
                a = addUnsigned(a, addUnsigned(addUnsigned(G(b, c, d), x), ac));
                return addUnsigned(rotateLeft(a, s), b);
            }
            function HH(a, b, c, d, x, s, ac) {
                a = addUnsigned(a, addUnsigned(addUnsigned(H(b, c, d), x), ac));
                return addUnsigned(rotateLeft(a, s), b);
            }
            function II(a, b, c, d, x, s, ac) {
                a = addUnsigned(a, addUnsigned(addUnsigned(I(b, c, d), x), ac));
                return addUnsigned(rotateLeft(a, s), b);
            }
            function convertToWordArray(string) {
                var messageLength = string.length;
                var numberOfWords = (((messageLength + 8) - ((messageLength + 8) % 64)) / 64 + 1) * 16;
                var wordArray = new Array(numberOfWords - 1);
                var bytePosition = 0, wordCount = 0;
                while (bytePosition < messageLength) {
                    wordCount = (bytePosition - (bytePosition % 4)) / 4;
                    var byteOffset = (bytePosition % 4) * 8;
                    wordArray[wordCount] = (wordArray[wordCount] | (string.charCodeAt(bytePosition) << byteOffset));
                    bytePosition++;
                }
                wordCount = (bytePosition - (bytePosition % 4)) / 4;
                var byteOffset = (bytePosition % 4) * 8;
                wordArray[wordCount] = wordArray[wordCount] | (0x80 << byteOffset);
                wordArray[numberOfWords - 2] = messageLength << 3;
                wordArray[numberOfWords - 1] = messageLength >>> 29;
                return wordArray;
            }
            function wordToHex(value) {
                var hex = "", temp = "", byte;
                for (var i = 0; i <= 3; i++) {
                    byte = (value >>> (i * 8)) & 255;
                    temp = "0" + byte.toString(16);
                    hex = hex + temp.substr(temp.length - 2, 2);
                }
                return hex;
            }
            function utf8Encode(string) {
                var utftext = "";
                for (var n = 0; n < string.length; n++) {
                    var c = string.charCodeAt(n);
                    if (c < 128) {
                        utftext += String.fromCharCode(c);
                    } else if (c > 127 && c < 2048) {
                        utftext += String.fromCharCode((c >> 6) | 192);
                        utftext += String.fromCharCode((c & 63) | 128);
                    } else {
                        utftext += String.fromCharCode((c >> 12) | 224);
                        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                        utftext += String.fromCharCode((c & 63) | 128);
                    }
                }
                return utftext;
            }
            var x = convertToWordArray(utf8Encode(string));
            var a = 0x67452301, b = 0xEFCDAB89, c = 0x98BADCFE, d = 0x10325476;
            var S11=7, S12=12, S13=17, S14=22, S21=5, S22=9, S23=14, S24=20;
            var S31=4, S32=11, S33=16, S34=23, S41=6, S42=10, S43=15, S44=21;
            for (var k = 0; k < x.length; k += 16) {
                var AA = a, BB = b, CC = c, DD = d;
                a = FF(a,b,c,d,x[k+0],S11,0xD76AA478); d = FF(d,a,b,c,x[k+1],S12,0xE8C7B756);
                c = FF(c,d,a,b,x[k+2],S13,0x242070DB); b = FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);
                a = FF(a,b,c,d,x[k+4],S11,0xF57C0FAF); d = FF(d,a,b,c,x[k+5],S12,0x4787C62A);
                c = FF(c,d,a,b,x[k+6],S13,0xA8304613); b = FF(b,c,d,a,x[k+7],S14,0xFD469501);
                a = FF(a,b,c,d,x[k+8],S11,0x698098D8); d = FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);
                c = FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1); b = FF(b,c,d,a,x[k+11],S14,0x895CD7BE);
                a = FF(a,b,c,d,x[k+12],S11,0x6B901122); d = FF(d,a,b,c,x[k+13],S12,0xFD987193);
                c = FF(c,d,a,b,x[k+14],S13,0xA679438E); b = FF(b,c,d,a,x[k+15],S14,0x49B40821);
                a = GG(a,b,c,d,x[k+1],S21,0xF61E2562); d = GG(d,a,b,c,x[k+6],S22,0xC040B340);
                c = GG(c,d,a,b,x[k+11],S23,0x265E5A51); b = GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);
                a = GG(a,b,c,d,x[k+5],S21,0xD62F105D); d = GG(d,a,b,c,x[k+10],S22,0x2441453);
                c = GG(c,d,a,b,x[k+15],S23,0xD8A1E681); b = GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);
                a = GG(a,b,c,d,x[k+9],S21,0x21E1CDE6); d = GG(d,a,b,c,x[k+14],S22,0xC33707D6);
                c = GG(c,d,a,b,x[k+3],S23,0xF4D50D87); b = GG(b,c,d,a,x[k+8],S24,0x455A14ED);
                a = GG(a,b,c,d,x[k+13],S21,0xA9E3E905); d = GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);
                c = GG(c,d,a,b,x[k+7],S23,0x676F02D9); b = GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);
                a = HH(a,b,c,d,x[k+5],S31,0xFFFA3942); d = HH(d,a,b,c,x[k+8],S32,0x8771F681);
                c = HH(c,d,a,b,x[k+11],S33,0x6D9D6122); b = HH(b,c,d,a,x[k+14],S34,0xFDE5380C);
                a = HH(a,b,c,d,x[k+1],S31,0xA4BEEA44); d = HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);
                c = HH(c,d,a,b,x[k+7],S33,0xF6BB4B60); b = HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);
                a = HH(a,b,c,d,x[k+13],S31,0x289B7EC6); d = HH(d,a,b,c,x[k+0],S32,0xEAA127FA);
                c = HH(c,d,a,b,x[k+3],S33,0xD4EF3085); b = HH(b,c,d,a,x[k+6],S34,0x4881D05);
                a = HH(a,b,c,d,x[k+9],S31,0xD9D4D039); d = HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);
                c = HH(c,d,a,b,x[k+15],S33,0x1FA27CF8); b = HH(b,c,d,a,x[k+2],S34,0xC4AC5665);
                a = II(a,b,c,d,x[k+0],S41,0xF4292244); d = II(d,a,b,c,x[k+7],S42,0x432AFF97);
                c = II(c,d,a,b,x[k+14],S43,0xAB9423A7); b = II(b,c,d,a,x[k+5],S44,0xFC93A039);
                a = II(a,b,c,d,x[k+12],S41,0x655B59C3); d = II(d,a,b,c,x[k+3],S42,0x8F0CCC92);
                c = II(c,d,a,b,x[k+10],S43,0xFFEFF47D); b = II(b,c,d,a,x[k+1],S44,0x85845DD1);
                a = II(a,b,c,d,x[k+8],S41,0x6FA87E4F); d = II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);
                c = II(c,d,a,b,x[k+6],S43,0xA3014314); b = II(b,c,d,a,x[k+13],S44,0x4E0811A1);
                a = II(a,b,c,d,x[k+4],S41,0xF7537E82); d = II(d,a,b,c,x[k+11],S42,0xBD3AF235);
                c = II(c,d,a,b,x[k+2],S43,0x2AD7D2BB); b = II(b,c,d,a,x[k+9],S44,0xEB86D391);
                a = addUnsigned(a, AA); b = addUnsigned(b, BB);
                c = addUnsigned(c, CC); d = addUnsigned(d, DD);
            }
            return (wordToHex(a) + wordToHex(b) + wordToHex(c) + wordToHex(d)).toLowerCase();
        }

        const platforms = [
            { name: 'GitHub', url: 'https://github.com/{u}', icon: 'üêô' },
            { name: 'Twitter', url: 'https://twitter.com/{u}', icon: 'ùïè' },
            { name: 'Instagram', url: 'https://instagram.com/{u}', icon: 'üì∑' },
            { name: 'LinkedIn', url: 'https://linkedin.com/in/{u}', icon: 'üíº' },
            { name: 'Reddit', url: 'https://reddit.com/user/{u}', icon: 'ü§ñ' },
            { name: 'YouTube', url: 'https://youtube.com/@{u}', icon: '‚ñ∂Ô∏è' },
            { name: 'TikTok', url: 'https://tiktok.com/@{u}', icon: 'üéµ' },
            { name: 'Medium', url: 'https://medium.com/@{u}', icon: 'üìù' },
            { name: 'Pinterest', url: 'https://pinterest.com/{u}', icon: 'üìå' },
            { name: 'Twitch', url: 'https://twitch.tv/{u}', icon: 'üì∫' },
            { name: 'Steam', url: 'https://steamcommunity.com/id/{u}', icon: 'üéÆ' },
            { name: 'Spotify', url: 'https://open.spotify.com/user/{u}', icon: 'üéß' },
        ];

        async function analyze() {
            const input = document.getElementById('input').value.trim();
            if (!input) return alert('Please enter an email or username');

            const isEmail = input.includes('@');
            const username = isEmail ? input.split('@')[0] : input;
            const email = isEmail ? input.toLowerCase() : null;

            analysisData = { input, username, email, timestamp: new Date().toISOString() };

            // Show loading
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').classList.remove('active');

            const steps = [
                'Checking profile pictures...',
                'Scanning social platforms...',
                'Generating search queries...',
                'Calculating exposure score...'
            ];

            let stepIndex = 0;
            const stepInterval = setInterval(() => {
                if (stepIndex < steps.length) {
                    document.getElementById('loadingStep').textContent = steps[stepIndex];
                    stepIndex++;
                }
            }, 600);

            // Check Gravatar
            let hasGravatar = false;
            if (email) {
                const hash = md5(email);
                try {
                    const response = await fetch(`https://www.gravatar.com/avatar/${hash}?d=404&s=200`);
                    hasGravatar = response.ok;
                    analysisData.gravatarHash = hash;
                } catch (e) {}
            }

            // Simulate analysis time
            await new Promise(r => setTimeout(r, 2500));
            clearInterval(stepInterval);

            // Update HIBP link
            if (email) {
                document.getElementById('hibpLink').href = `https://haveibeenpwned.com/account/${encodeURIComponent(email)}`;
            }

            // Update Gravatar card
            const gravatarContent = document.getElementById('gravatarContent');
            const gravatarStatus = document.getElementById('gravatarStatus');
            if (hasGravatar) {
                gravatarStatus.textContent = 'Found';
                gravatarStatus.className = 'status found';
                gravatarContent.innerHTML = `
                    <img src="https://www.gravatar.com/avatar/${analysisData.gravatarHash}?s=200" class="gravatar-img">
                    <div class="gravatar-info">
                        <p><strong>Profile picture found!</strong></p>
                        <p>This image is linked to your email and visible on WordPress, GitHub, and other services.</p>
                    </div>
                `;
                analysisData.gravatar = true;
            } else {
                gravatarStatus.textContent = 'Not Found';
                gravatarStatus.className = 'status safe';
                gravatarContent.innerHTML = `
                    <div class="gravatar-img" style="display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: var(--text-muted);">?</div>
                    <div class="gravatar-info">
                        <p><strong>No global profile picture</strong></p>
                        <p>This email doesn't have a Gravatar linked. Good for privacy!</p>
                    </div>
                `;
                analysisData.gravatar = false;
            }

            // Generate accounts grid
            const accountsGrid = document.getElementById('accountsGrid');
            accountsGrid.innerHTML = platforms.map(p => `
                <a href="${p.url.replace('{u}', username)}" target="_blank" class="account-item">
                    <span class="icon">${p.icon}</span>
                    <span>${p.name}</span>
                    <span class="arrow">‚Üí</span>
                </a>
            `).join('');
            document.getElementById('accountsStatus').textContent = `${platforms.length} to check`;
            document.getElementById('accountsStatus').className = 'status warning';
            analysisData.platforms = platforms.length;

            // Generate dorks
            const dorks = [
                { query: `"${input}"`, desc: 'Find exact mentions of your email/username across the web' },
                { query: `"${username}" site:tripadvisor.com OR site:yelp.com`, desc: 'Find travel reviews and restaurant reviews (reveals locations & habits)' },
                { query: `"${username}" site:google.com/maps/contrib`, desc: 'Find Google Maps reviews and contributions' },
                { query: `"${input}" filetype:pdf OR filetype:doc`, desc: 'Find documents that contain your information' },
                { query: `"${username}" site:reddit.com`, desc: 'Find Reddit posts and comments' },
            ];

            document.getElementById('dorksList').innerHTML = dorks.map(d => `
                <div class="dork-item">
                    <div class="dork-query">${d.query}</div>
                    <div class="dork-desc">${d.desc}</div>
                    <button class="dork-btn" onclick="window.open('https://google.com/search?q=${encodeURIComponent(d.query)}', '_blank')">
                        Search on Google ‚Üí
                    </button>
                </div>
            `).join('');
            analysisData.dorks = dorks;

            // Calculate exposure score
            let score = 30; // Base
            if (hasGravatar) score += 20;
            if (isEmail) score += 15;
            score += Math.min(platforms.length * 2, 30);

            const scoreColor = score >= 70 ? 'var(--red)' : score >= 40 ? 'var(--yellow)' : 'var(--accent)';
            const scoreTitle = score >= 70 ? 'High Exposure' : score >= 40 ? 'Moderate Exposure' : 'Low Exposure';
            const scoreDesc = score >= 70
                ? 'Your digital footprint is significant. Attackers have multiple vectors to target you.'
                : score >= 40
                ? 'You have a moderate online presence. Consider reducing unnecessary exposure.'
                : 'Your digital footprint is relatively small. Maintain good privacy practices.';

            analysisData.score = score;
            analysisData.scoreTitle = scoreTitle;

            // Animate score
            const scoreFill = document.getElementById('scoreFill');
            const scoreNumber = document.getElementById('scoreNumber');
            scoreFill.style.stroke = scoreColor;
            scoreFill.style.strokeDashoffset = 283 - (283 * score / 100);

            let currentScore = 0;
            const scoreInterval = setInterval(() => {
                if (currentScore < score) {
                    currentScore++;
                    scoreNumber.textContent = currentScore;
                    scoreNumber.style.color = scoreColor;
                } else {
                    clearInterval(scoreInterval);
                }
            }, 20);

            document.getElementById('scoreTitle').textContent = scoreTitle;
            document.getElementById('scoreDesc').textContent = scoreDesc;
            document.getElementById('foundCount').textContent = hasGravatar ? '1 profile found' : '0 profiles found';
            document.getElementById('riskCount').textContent = '4 risk factors';

            // Show results
            document.getElementById('loading').classList.remove('active');
            document.getElementById('results').classList.add('active');
            document.getElementById('analyzeBtn').disabled = false;
        }

        function copyReport() {
            const report = generateTextReport();
            navigator.clipboard.writeText(report);
            alert('Report copied to clipboard!');
        }

        function downloadReport() {
            const report = generateTextReport();
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `vigia-report-${analysisData.username}-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
        }

        function generateTextReport() {
            return `
================================================================================
                        VIG√çA DIGITAL FOOTPRINT REPORT
================================================================================

Generated: ${new Date().toLocaleString()}
Input: ${analysisData.input}
Username: ${analysisData.username}

--------------------------------------------------------------------------------
                              EXPOSURE SCORE: ${analysisData.score}/100
                              Status: ${analysisData.scoreTitle}
--------------------------------------------------------------------------------

FINDINGS:
---------
‚Ä¢ Gravatar Profile: ${analysisData.gravatar ? 'FOUND - Profile picture publicly linked to email' : 'Not found'}
‚Ä¢ Platforms to Check: ${analysisData.platforms}

SEARCH QUERIES USED:
--------------------
${analysisData.dorks?.map(d => `‚Ä¢ ${d.query}\n  ${d.desc}`).join('\n\n')}

RISK FACTORS:
-------------
‚Ä¢ Phishing: Personalized scam emails mentioning your accounts
‚Ä¢ Social Engineering: Using your public info to gain trust
‚Ä¢ Credential Stuffing: Leaked passwords tried on other accounts
‚Ä¢ Vishing: Fake calls with real data about you

RECOMMENDATIONS:
----------------
‚úì Use unique passwords for each account (use a password manager)
‚úì Enable 2FA on all critical accounts
‚úì Use email aliases for new signups (SimpleLogin, Firefox Relay)
‚úì Review and delete old unused accounts
‚úì Monitor your email on haveibeenpwned.com

================================================================================
                    Powered by FK94 Security | fk94security.com
================================================================================
            `.trim();
        }
    </script>
</body>
</html>
